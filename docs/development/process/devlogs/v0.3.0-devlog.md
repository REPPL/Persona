# DevLog: v0.3.0 - Multi-Variation

## Implementation Narrative

v0.3.0 introduces variation support for persona generation - enabling different complexity and detail levels to match use case requirements. It also adds substantial support for co-creation workshop workflows.

### Synthetic Data Generation (F-028)

The synthetic data generator creates mock interview data for demos and testing. Key design decisions:
- Uses gender-neutral participant IDs (P001, P002) rather than names
- No gender field in demographics
- Role-based identification only
- Bias mitigation per R-003 and R-008 research

Six domains supported: ecommerce, healthcare, fintech, education, saas, general. Each has domain-specific questions, roles, and response fragments.

### Empathy Map Input (F-029)

The EmpathyMapLoader handles YAML/JSON input structured around the five Boag dimensions: Tasks, Feelings, Influences, Pain Points, Goals. Validation supports both strict mode (all dimensions required) and non-strict mode (warnings for empty dimensions).

### Empathy Table Output (F-030)

The EmpathyTableFormatter renders empathy map data as tables in Markdown, HTML, or Rich terminal format. Supports converting both empathy maps and personas into the table structure.

### Workshop Import (F-031)

The WorkshopImporter processes workshop photos (mock implementation currently). Uses a Protocol-based VisionExtractor interface enabling easy substitution of mock or real LLM backends. The mock extractor generates deterministic test data based on filename hints.

Output is editable YAML that feeds directly into the empathy map loader.

### Complexity and Detail Levels (F-033, F-034)

Three complexity levels (simple, moderate, complex) define structural requirements:
- Simple: Demographics only, 2-3 goals/pain points
- Moderate: Demographics + behaviours, 4-6 items
- Complex: Full schema, 7-10 items, evidence required

Two detail levels (minimal, detailed) define narrative depth:
- Minimal: Bullet points, 1-2 sentences
- Detailed: Flowing prose, 3-5 sentences, quotes

### Variation Matrix (F-035)

The VariationMatrix generates all 6 combinations of complexity and detail levels. Each variation has token multipliers for cost estimation.

## Challenges Encountered

- **Bias Testing**: Initially just documented bias mitigation in docstrings. User required explicit tests. Added TestBiasMitigation class with 6 tests verifying gender-neutral IDs, no gender demographics, no gendered names in roles, balanced age distribution, and no stereotypes in responses.

- **Module Organisation**: F-033/F-034/F-035 started as separate features but shared so much code that combining them into a single variations module was more efficient.

- **Empathy Map Validation**: Strict vs non-strict mode needed careful handling - strict mode fails on empty dimensions while non-strict only warns.

## Code Highlights

**Bias Mitigation (per R-008 research)**:
```python
# Gender-neutral participant IDs
return SyntheticParticipant(
    id=f"P{participant_id:03d}",  # P001, P002, etc.
    role=role,  # Role-based, not name-based
    demographics={
        "age_group": random.choice(["18-24", "25-34", ...]),
        "experience": random.choice([...]),
        "tech_comfort": random.choice([...]),
        # No gender field
    },
)
```

**Variation Token Multipliers**:
```python
COMPLEXITY_SPECS = {
    ComplexityLevel.SIMPLE: ComplexitySpec(token_multiplier=0.5),
    ComplexityLevel.MODERATE: ComplexitySpec(token_multiplier=1.0),
    ComplexityLevel.COMPLEX: ComplexitySpec(token_multiplier=1.8),
}

DETAIL_SPECS = {
    DetailLevel.MINIMAL: DetailSpec(token_multiplier=0.6),
    DetailLevel.DETAILED: DetailSpec(token_multiplier=1.4),
}
```

## Dependencies Added

No new dependencies. Uses existing: pyyaml, dataclasses (stdlib), rich (optional for terminal tables).

---

**Status**: Complete
