# Manual Test Script: v0.5.0 - Extensibility + SDK

This script verifies all v0.5.0 functionality. Execute tests in order and record results.

## Prerequisites

- Python 3.12+
- Git checkout of v0.5.0 tag
- No API keys required (tests use mock responses)

## Installation

```bash
# 1. Checkout the version
git checkout v0.5.0

# 2. Create fresh virtual environment
python3.12 -m venv .venv-test
source .venv-test/bin/activate  # On Windows: .venv-test\Scripts\activate

# 3. Install Persona with all dependencies
pip install -e ".[all]"

# 4. Verify installation
python -c "import persona; print(f'Persona v{persona.__version__}')"
```

**Expected:** Shows Persona v0.5.0

---

## Test 1: Version Check

**Command:**
```bash
python -c "import persona; print(persona.__version__)"
```

**Expected:** Shows 0.5.0

**Pass Criteria:**
- [ ] Shows 0.5.0

---

## Test 2: Python SDK (F-087)

**Command:**
```bash
python -c "
from persona.sdk import PersonaSDK, GenerationConfig

sdk = PersonaSDK()
print('SDK initialised:', sdk is not None)
print('Default provider:', sdk._default_provider)

# Test config creation
config = GenerationConfig(
    provider='anthropic',
    model='claude-sonnet-4-20250514',
    count=3,
    complexity='moderate'
)
print('Config created:', config.model)
"
```

**Expected:** SDK initialises successfully, config creation works

**Pass Criteria:**
- [ ] SDK initialises successfully
- [ ] Config creation works

---

## Test 3: Async Support (F-088)

**Command:**
```bash
python -c "
import asyncio
from persona.sdk import PersonaSDK

async def test_async():
    sdk = PersonaSDK()
    # Check async methods exist
    print('has generate_async:', hasattr(sdk, 'generate_async'))
    print('has validate_async:', hasattr(sdk, 'validate_async'))
    return True

result = asyncio.run(test_async())
print('Async test passed:', result)
"
```

**Expected:** Async methods exist on SDK, async test passes

**Pass Criteria:**
- [ ] Async methods exist on SDK
- [ ] Async test passes

---

## Test 4: Custom Vendor Configuration (F-043)

**Command:**
```bash
persona vendor list
```

**Expected:** Shows built-in providers (anthropic, openai, gemini), shows custom vendors section

**Pass Criteria:**
- [ ] Shows built-in providers (anthropic, openai, gemini)
- [ ] Shows custom vendors section

**Command:**
```bash
persona vendor add test-vendor \
    --name "Test Vendor" \
    --api-base "https://api.test.example.com" \
    --auth-env TEST_API_KEY \
    --force
```

**Expected:** Vendor added successfully

**Pass Criteria:**
- [ ] Vendor added successfully

**Command:**
```bash
persona vendor show test-vendor
```

**Expected:** Shows vendor details

**Pass Criteria:**
- [ ] Shows vendor details

**Command:**
```bash
persona vendor remove test-vendor --force
```

**Expected:** Vendor removed successfully

**Pass Criteria:**
- [ ] Vendor removed successfully

---

## Test 5: Custom Model Configuration (F-044)

**Command:**
```bash
persona model list
```

**Expected:** Shows built-in models by provider, shows custom models section

**Pass Criteria:**
- [ ] Shows built-in models by provider
- [ ] Shows custom models section

**Command:**
```bash
persona model add test-model \
    --name "Test Model" \
    --provider openai \
    --context 128000 \
    --input-price 5.00 \
    --output-price 15.00 \
    --force
```

**Expected:** Model added successfully

**Pass Criteria:**
- [ ] Model added successfully

**Command:**
```bash
persona model show test-model
```

**Expected:** Shows model details including pricing

**Pass Criteria:**
- [ ] Shows model details including pricing

**Command:**
```bash
persona model pricing --provider openai
```

**Expected:** Shows pricing table for OpenAI models

**Pass Criteria:**
- [ ] Shows pricing table for OpenAI models

**Command:**
```bash
persona model remove test-model --force
```

**Expected:** Model removed successfully

**Pass Criteria:**
- [ ] Model removed successfully

---

## Test 6: Custom Prompt Templates (F-046)

**Command:**
```bash
persona template list
```

**Expected:** Shows built-in templates (default, healthcare), shows template metadata

**Pass Criteria:**
- [ ] Shows built-in templates (default, healthcare)
- [ ] Shows template metadata

**Command:**
```bash
persona template show default --content
```

**Expected:** Shows template content, shows required variables

**Pass Criteria:**
- [ ] Shows template content
- [ ] Shows required variables

**Command:**
```bash
persona template create my-template --name "My Template" --force
```

**Expected:** Template created successfully

**Pass Criteria:**
- [ ] Template created successfully

**Command:**
```bash
persona template test my-template
```

**Expected:** Template renders without errors

**Pass Criteria:**
- [ ] Template renders without errors

**Command:**
```bash
persona template remove my-template --force
```

**Expected:** Template removed successfully

**Pass Criteria:**
- [ ] Template removed successfully

---

## Test 7: Custom Workflow Configuration (F-045)

**Command:**
```bash
persona workflow list
```

**Expected:** Shows built-in workflows (default, multi-step), shows workflow metadata

**Pass Criteria:**
- [ ] Shows built-in workflows (default, multi-step)
- [ ] Shows workflow metadata

**Command:**
```bash
persona workflow show default
```

**Expected:** Shows workflow details, shows steps in workflow

**Pass Criteria:**
- [ ] Shows workflow details
- [ ] Shows steps in workflow

**Command:**
```bash
persona workflow create my-workflow --name "My Workflow" --force
```

**Expected:** Workflow created successfully

**Pass Criteria:**
- [ ] Workflow created successfully

**Command:**
```bash
persona workflow validate my-workflow
```

**Expected:** Workflow validates successfully

**Pass Criteria:**
- [ ] Workflow validates successfully

**Command:**
```bash
persona workflow remove my-workflow --force
```

**Expected:** Workflow removed successfully

**Pass Criteria:**
- [ ] Workflow removed successfully

---

## Test 8: Dynamic Vendor Discovery (F-047)

**Command:**
```bash
persona vendor discover
```

**Expected:** Shows discovery results, categorises by status (Available, Not Configured, Unavailable), shows response times for reachable endpoints

**Pass Criteria:**
- [ ] Shows discovery results
- [ ] Categorises by status (Available, Not Configured, Unavailable)
- [ ] Shows response times for reachable endpoints

---

## Test 9: Dynamic Model Discovery (F-048)

**Command:**
```bash
persona model discover
```

**Expected:** Shows discovered models by provider, shows model status (available, deprecated), groups results by provider

**Pass Criteria:**
- [ ] Shows discovered models by provider
- [ ] Shows model status (available, deprecated)
- [ ] Groups results by provider

**Command:**
```bash
persona model check gpt-4o
```

**Expected:** Shows availability status, shows any deprecation warnings

**Pass Criteria:**
- [ ] Shows availability status
- [ ] Shows any deprecation warnings

---

## Test 10: Edit Experiment Command (F-049)

**Command:**
```bash
persona experiment create test-edit-exp --base-dir /tmp/persona-test
```

**Expected:** Experiment created

**Pass Criteria:**
- [ ] Experiment created

**Command:**
```bash
persona experiment edit test-edit-exp --base-dir /tmp/persona-test
```

**Expected:** Shows current configuration, shows usage examples

**Pass Criteria:**
- [ ] Shows current configuration
- [ ] Shows usage examples

**Command:**
```bash
persona experiment edit test-edit-exp --set count=5 --base-dir /tmp/persona-test
```

**Expected:** Field updated successfully

**Pass Criteria:**
- [ ] Field updated successfully

**Command:**
```bash
persona experiment edit test-edit-exp --set provider=openai --set model=gpt-4o --base-dir /tmp/persona-test
```

**Expected:** Multiple fields updated

**Pass Criteria:**
- [ ] Multiple fields updated

**Command:**
```bash
echo "test,data" > /tmp/test-source.csv
persona experiment edit test-edit-exp --add-source /tmp/test-source.csv --base-dir /tmp/persona-test
```

**Expected:** Source added successfully

**Pass Criteria:**
- [ ] Source added successfully

**Command:**
```bash
persona experiment sources test-edit-exp --base-dir /tmp/persona-test
```

**Expected:** Shows added source

**Pass Criteria:**
- [ ] Shows added source

**Command:**
```bash
persona experiment edit test-edit-exp --rollback 1 --base-dir /tmp/persona-test
```

**Expected:** Rollback successful

**Pass Criteria:**
- [ ] Rollback successful

---

## Test 11: Experiment History Command (F-050)

**Command:**
```bash
persona experiment record-run test-edit-exp \
    --model gpt-4o --provider openai \
    --personas 3 --cost 0.45 \
    --base-dir /tmp/persona-test
```

**Expected:** Run recorded successfully

**Pass Criteria:**
- [ ] Run recorded successfully

**Command:**
```bash
persona experiment record-run test-edit-exp \
    --model claude-sonnet-4.5 --provider anthropic \
    --personas 5 --cost 0.72 \
    --base-dir /tmp/persona-test
```

**Expected:** Second run recorded

**Pass Criteria:**
- [ ] Second run recorded

**Command:**
```bash
persona experiment history test-edit-exp --base-dir /tmp/persona-test
```

**Expected:** Shows run history table with run IDs, timestamps, models, costs

**Pass Criteria:**
- [ ] Shows run history table
- [ ] Shows run IDs, timestamps, models, costs

**Command:**
```bash
persona experiment history test-edit-exp --stats --base-dir /tmp/persona-test
```

**Expected:** Shows aggregate statistics including total runs, personas, cost

**Pass Criteria:**
- [ ] Shows aggregate statistics
- [ ] Shows total runs, personas, cost

**Command:**
```bash
persona experiment history test-edit-exp --diff "1,2" --base-dir /tmp/persona-test
```

**Expected:** Shows comparison between runs, shows differences and deltas

**Pass Criteria:**
- [ ] Shows comparison between runs
- [ ] Shows differences and deltas

**Command:**
```bash
persona experiment history test-edit-exp --last 1 --base-dir /tmp/persona-test
```

**Expected:** Shows only the most recent run

**Pass Criteria:**
- [ ] Shows only the most recent run

**Command:**
```bash
persona experiment clear-history test-edit-exp --force --base-dir /tmp/persona-test
```

**Expected:** History cleared successfully

**Pass Criteria:**
- [ ] History cleared successfully

---

## Test 12: Cleanup

**Command:**
```bash
persona experiment delete test-edit-exp --force --base-dir /tmp/persona-test
rm -rf /tmp/persona-test /tmp/test-source.csv
```

**Expected:** Experiment deleted, temp files cleaned up

**Pass Criteria:**
- [ ] Experiment deleted
- [ ] Temp files cleaned up

---

## Test 13: Run Automated Tests

**Command:**
```bash
pytest tests/ -q
```

**Expected:** All 1494 tests pass

**Pass Criteria:**
- [ ] All tests pass

---

## Results Summary

| Test | Status | Notes |
|------|--------|-------|
| 1. Version Check | ⬜ | |
| 2. Python SDK | ⬜ | |
| 3. Async Support | ⬜ | |
| 4. Custom Vendor Configuration | ⬜ | |
| 5. Custom Model Configuration | ⬜ | |
| 6. Custom Prompt Templates | ⬜ | |
| 7. Custom Workflow Configuration | ⬜ | |
| 8. Dynamic Vendor Discovery | ⬜ | |
| 9. Dynamic Model Discovery | ⬜ | |
| 10. Edit Experiment Command | ⬜ | |
| 11. Experiment History Command | ⬜ | |
| 12. Cleanup | ⬜ | |
| 13. Automated Tests | ⬜ | |

**Overall Result:** ⬜ Pass / ⬜ Fail

---

## Sharing Results

After completing all tests, share:

1. The completed results table above
2. Console output from any failed tests
3. Your environment details:
   - OS:
   - Python version:
   - Any issues encountered

Paste results to Claude for review.
