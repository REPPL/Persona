# Manual Test Script: v0.2.0 - Multi-Step Workflows

This script verifies all v0.2.0 functionality. Execute tests in order and record results.

## Prerequisites

- Python 3.12+
- Git checkout of v0.2.0 tag
- At least one API key (OpenAI, Anthropic, or Google) for real API tests
- OR use mock mode for testing without API keys

## Installation

```bash
# 1. Checkout the version
git checkout v0.2.0

# 2. Create fresh virtual environment
python3.12 -m venv .venv-test
source .venv-test/bin/activate  # On Windows: .venv-test\Scripts\activate

# 3. Install Persona
pip install -e .

# 4. Verify installation
persona --version
```

**Expected:** Shows Persona v0.2.0

---

## Test 1: CLI Health Check

**Command:**
```bash
persona check
```

**Expected:** Shows version 0.2.0, shows green status (or yellow with unconfigured providers - expected)

**Pass Criteria:**
- [ ] Shows version 0.2.0
- [ ] Shows green status (or yellow with unconfigured providers - expected)

---

## Test 2: Import Test

**Command:**
```bash
python -c "
from persona.core.validation import PersonaValidator, ValidationResult
from persona.core.batch import BatchProcessor, BatchResult
from persona.core.comparison import PersonaComparator, ComparisonResult
from persona.core.preview import DataPreviewer, PreviewResult
from persona.core.templates import TemplateManager, PersonaTemplate
from persona.core.evidence import EvidenceLinker, Evidence
from persona.core.refinement import PersonaRefiner, RefinementSession
from persona.core.export import PersonaExporter, ExportFormat
from persona.core.clustering import PersonaClusterer, ClusterResult
print('All v0.2.0 modules import successfully')
"
```

**Expected:** Prints "All v0.2.0 modules import successfully" with no import errors

**Pass Criteria:**
- [ ] Prints success message with no import errors

---

## Test 3: Validation Module

**Command:**
```bash
python -c "
from persona.core.validation import PersonaValidator
from persona.core.generation.parser import Persona

validator = PersonaValidator()
persona = Persona(id='test', name='Test User', goals=['Goal 1'])
result = validator.validate(persona)
print(f'Validation: {result.is_valid}, Errors: {len(result.errors)}, Warnings: {len(result.warnings)}')
"
```

**Expected:** Shows validation result (should be valid with warnings for missing fields)

**Pass Criteria:**
- [ ] Shows validation result (should be valid with warnings for missing fields)

---

## Test 4: Comparison Module

**Command:**
```bash
python -c "
from persona.core.comparison import PersonaComparator
from persona.core.generation.parser import Persona

comparator = PersonaComparator()
p1 = Persona(id='p1', name='Alice', goals=['Goal A', 'Goal B'])
p2 = Persona(id='p2', name='Bob', goals=['Goal A', 'Goal C'])
result = comparator.compare(p1, p2)
print(f'Similarity: {result.similarity.overall:.1%}')
"
```

**Expected:** Shows similarity percentage (should be ~30-50%)

**Pass Criteria:**
- [ ] Shows similarity percentage (should be ~30-50%)

---

## Test 5: Template Module

**Command:**
```bash
python -c "
from persona.core.templates import TemplateManager

manager = TemplateManager()
templates = manager.list_templates()
print(f'Available templates: {len(templates)}')
for t in templates[:3]:
    print(f'  - {t.name} ({t.category.value})')
"
```

**Expected:** Shows 4+ templates (ux_research, marketing, academic, product)

**Pass Criteria:**
- [ ] Shows 4+ templates (ux_research, marketing, academic, product)

---

## Test 6: Export Module

**Command:**
```bash
python -c "
from persona.core.export import PersonaExporter, ExportFormat
from persona.core.generation.parser import Persona

exporter = PersonaExporter()
formats = exporter.list_formats()
print(f'Export formats: {len(formats)}')
for f in formats:
    print(f'  - {f[\"id\"]}: {f[\"name\"]}')
"
```

**Expected:** Shows 7 export formats (json, markdown, html, figma, miro, uxpressia, csv)

**Pass Criteria:**
- [ ] Shows 7 export formats (json, markdown, html, figma, miro, uxpressia, csv)

---

## Test 7: Clustering Module

**Command:**
```bash
python -c "
from persona.core.clustering import PersonaClusterer
from persona.core.generation.parser import Persona

clusterer = PersonaClusterer(similarity_threshold=0.5)
personas = [
    Persona(id='p1', name='Dev1', goals=['Code'], demographics={'role': 'Developer'}),
    Persona(id='p2', name='Dev2', goals=['Code'], demographics={'role': 'Developer'}),
    Persona(id='p3', name='Mgr1', goals=['Lead'], demographics={'role': 'Manager'}),
]
result = clusterer.cluster(personas)
print(f'Clusters: {result.cluster_count}, Total personas: {result.total_personas}')
"
```

**Expected:** Shows cluster count (should be 1-2 clusters)

**Pass Criteria:**
- [ ] Shows cluster count (should be 1-2 clusters)

---

## Test 8: Run Automated Tests

**Command:**
```bash
pip install pytest
pytest tests/unit/core/test_validation.py tests/unit/core/test_export.py tests/unit/core/test_clustering.py -v --tb=short 2>&1 | tail -20
```

**Expected:** All tests pass

**Pass Criteria:**
- [ ] All tests pass

---

## Results Summary

| Test | Status | Notes |
|------|--------|-------|
| 1. CLI Health Check | ⬜ | |
| 2. Import Test | ⬜ | |
| 3. Validation Module | ⬜ | |
| 4. Comparison Module | ⬜ | |
| 5. Template Module | ⬜ | |
| 6. Export Module | ⬜ | |
| 7. Clustering Module | ⬜ | |
| 8. Automated Tests | ⬜ | |

**Overall Result:** ⬜ Pass / ⬜ Fail

---

## Sharing Results

After completing all tests, share:

1. The completed results table above
2. Console output from any failed tests
3. Your environment details:
   - OS:
   - Python version:
   - Any issues encountered

Paste results to Claude for review.
