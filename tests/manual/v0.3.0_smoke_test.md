# Smoke Test: v0.3.0 (5-10 minutes)

## Prerequisites

- Python 3.12+
- Git checkout of v0.3.0 tag
- At least one API key (OpenAI, Anthropic, or Google) for real API tests
- OR use mock mode for testing without API keys

## Installation

```bash
# 1. Checkout the version
git checkout v0.3.0

# 2. Create fresh virtual environment
python3.12 -m venv .venv-test
source .venv-test/bin/activate  # On Windows: .venv-test\Scripts\activate

# 3. Install Persona
pip install -e .

# 4. Verify installation
persona --version
```

**Expected Output:**
```
Persona v0.3.0
```

---

## Quick Verification

### 1. CLI Health Check
```bash
persona check
```
- [ ] Shows version 0.3.0
- [ ] Shows green status (or yellow with unconfigured providers - expected)

### 2. Import Test - v0.3.0 Modules
```bash
python -c "
from persona.core.synthetic import (
    SyntheticDataGenerator,
    SyntheticInterview,
    SyntheticParticipant,
    DataDomain,
    GenerationConfig,
)
from persona.core.data import (
    EmpathyMap,
    EmpathyMapDimension,
    EmpathyMapLoader,
    ParticipantTypeMap,
    WorkshopImporter,
    WorkshopCategory,
)
from persona.core.output import (
    EmpathyTableFormatter,
    EmpathyTableRow,
    TableFormat,
)
from persona.core.generation import (
    ComplexityLevel,
    DetailLevel,
    VariationMatrix,
    PersonaVariation,
)
print('All v0.3.0 modules import successfully')
"
```
- [ ] Prints success message with no import errors

### 3. Synthetic Data Generation (F-028)
```bash
python -c "
from persona.core.synthetic import SyntheticDataGenerator, GenerationConfig, DataDomain

config = GenerationConfig(seed=42, participant_count=3)
generator = SyntheticDataGenerator(config)
interviews = generator.generate(domain=DataDomain.ECOMMERCE)

print(f'Generated {len(interviews)} interviews')
for i in interviews:
    print(f'  - {i.participant.id}: {i.participant.role}')
print(f'First interview has {len(interviews[0].questions)} questions')
"
```
- [ ] Generates 3 interviews
- [ ] Shows participant IDs (P001, P002, P003)
- [ ] Each interview has questions

### 4. Empathy Map Loading (F-029)
```bash
python -c "
from persona.core.data import EmpathyMapLoader

yaml_content = '''
participants: 10
method: workshop
data:
  - participant_type: power_user
    tasks: [\"Advanced features\"]
    feelings: [\"Confident\"]
    influences: [\"Documentation\"]
    pain_points: [\"Bugs\"]
    goals: [\"Mastery\"]
'''

import tempfile
from pathlib import Path

with tempfile.NamedTemporaryFile(suffix='.yaml', mode='w', delete=False) as f:
    f.write(yaml_content)
    path = f.name

loader = EmpathyMapLoader()
em = loader.load(Path(path))

print(f'Loaded empathy map with {len(em.data)} participant types')
print(f'Participant type: {em.data[0].participant_type}')
print(f'Goals: {em.data[0].goals}')
"
```
- [ ] Loads empathy map successfully
- [ ] Shows participant type "power_user"
- [ ] Shows goals list

### 5. Empathy Table Output (F-030)
```bash
python -c "
from persona.core.output import EmpathyTableFormatter, EmpathyTableRow
from persona.core.data import ParticipantTypeMap, EmpathyMap

# Create sample data
em = EmpathyMap(data=[
    ParticipantTypeMap(
        participant_type='Developer',
        tasks=['Code', 'Review'],
        feelings=['Focused'],
        influences=['Docs'],
        pain_points=['Bugs'],
        goals=['Ship features'],
    )
])

formatter = EmpathyTableFormatter()
rows = formatter.from_empathy_map(em)
md = formatter.to_markdown(rows)

print('Generated Markdown table:')
print(md[:300])
"
```
- [ ] Generates Markdown table
- [ ] Table has headers (Persona, Tasks, Feelings, etc.)

### 6. Workshop Import (F-031)
```bash
python -c "
from persona.core.data import WorkshopImporter, MockVisionExtractor
from pathlib import Path
import tempfile

# Create mock image
with tempfile.NamedTemporaryFile(suffix='.jpg', delete=False) as f:
    f.write(b'mock image')
    image_path = Path(f.name)

importer = WorkshopImporter()
results = importer.import_images([image_path])

print(f'Imported {len(results)} images')
print(f'Extracted {len(results[0].post_its)} post-it notes')
print(f'First note: {results[0].post_its[0].text[:50]}...')
"
```
- [ ] Imports mock image
- [ ] Extracts post-it notes
- [ ] Shows extracted text

### 7. Variation Matrix (F-033, F-034, F-035)
```bash
python -c "
from persona.core.generation import (
    VariationMatrix,
    ComplexityLevel,
    DetailLevel,
)

matrix = VariationMatrix()

print(f'Total variations: {len(matrix)}')
print()
print('Variation Matrix:')
for v in matrix:
    print(f'  {v.id}: {v.complexity.value}/{v.detail.value} (token mult: {v.token_multiplier:.2f})')
"
```
- [ ] Shows 6 variations (V1-V6)
- [ ] Each has complexity/detail combination
- [ ] Token multipliers shown

### 8. Run Automated Tests
```bash
# Install test dependencies first
pip install pytest

pytest tests/unit/core/test_synthetic.py tests/unit/core/test_empathy_map.py tests/unit/core/test_empathy_table.py tests/unit/core/test_workshop.py tests/unit/core/test_variations.py -v --tb=short 2>&1 | tail -20
```
- [ ] All tests pass (173 expected)

---

## Report

```markdown
# Manual Test Results: v0.3.0

**Tester:** ___
**Date:** YYYY-MM-DD
**Environment:** macOS/Linux/Windows

## Results Summary
- Total tests: 8
- Passed: ___
- Failed: ___

## Console Output
[Paste relevant console output here]

## Issues Found
[List any issues or unexpected behaviour]
```

---

**Expected Duration:** 5-10 minutes
