# Manual Test Script: Conversation Scripts (F-104)

This script verifies the conversation script generation functionality. Execute tests in order and record results.

## Prerequisites

- Python 3.12+
- Persona installed with `pip install -e ".[all]"`

## Setup

```bash
# 1. Activate virtual environment
source .venv-test/bin/activate  # On Windows: .venv-test\Scripts\activate

# 2. Verify installation
persona --version
```

**Expected:** Shows Persona version

---

## Test 1: Scripts Module Import

**Command:**
```python
from persona.core.scripts import ConversationGenerator
from persona.core.scripts.models import Script, Turn, Scenario

print("Scripts module imports successful")
```

**Expected:** All scripts modules importable

**Pass Criteria:**
- [ ] ConversationGenerator importable
- [ ] Script model importable
- [ ] Turn model importable
- [ ] No import errors

---

## Test 2: CLI Help

**Command:**
```bash
persona script --help
```

**Expected:** Shows help text with subcommands

**Pass Criteria:**
- [ ] Help text displays correctly
- [ ] generate subcommand documented
- [ ] journey subcommand documented
- [ ] No import errors

---

## Test 3: Script Models

**Command:**
```python
from persona.core.scripts.models import Turn, Script

# Create turn
turn = Turn(
    speaker="Alex Chen",
    dialogue="Hello, I need help with my account.",
    action="leans forward",
    emotion="frustrated",
)
print(f"Turn: {turn}")

# Create script
script = Script(
    title="Support Call",
    scenario="Customer needs billing help",
    personas=["Alex Chen", "Support Agent"],
    turns=[turn],
    metadata={"duration": "5 minutes"},
)
print(f"Script: {script.title}")
```

**Expected:** Models create correctly

**Pass Criteria:**
- [ ] Turn model works
- [ ] Script model works
- [ ] Optional fields handled
- [ ] Serialisation works

---

## Test 4: Generator Initialisation

**Command:**
```python
from persona.core.scripts import ConversationGenerator

# Default init
generator = ConversationGenerator()
print(f"Generator created: {generator}")

# With provider
generator = ConversationGenerator(provider="openai")
print("Custom generator created")
```

**Expected:** Generator initialises correctly

**Pass Criteria:**
- [ ] Default initialisation works
- [ ] Custom provider accepted
- [ ] Model selection works

---

## Test 5: Output Formatters

**Command:**
```python
from persona.core.scripts.formatters import (
    ScreenplayFormatter,
    ChatFormatter,
    JSONFormatter,
)
from persona.core.scripts.models import Turn, Script

# Create test script
script = Script(
    title="Test",
    scenario="Test scenario",
    personas=["A", "B"],
    turns=[Turn(speaker="A", dialogue="Hello")],
    metadata={},
)

# Test formatters
screenplay = ScreenplayFormatter().format(script)
assert "A" in screenplay
print("Screenplay format works")

chat = ChatFormatter().format(script)
assert "A:" in chat or "[A]" in chat
print("Chat format works")

json_out = JSONFormatter().format(script)
assert "title" in json_out
print("JSON format works")
```

**Expected:** All formatters produce output

**Pass Criteria:**
- [ ] Screenplay formatter works
- [ ] Chat formatter works
- [ ] JSON formatter works
- [ ] Markdown formatter works

---

## Test 6: CLI Generate Command

**Command:**
```bash
# Create test persona file first
echo '[{"name": "Alex", "goals": ["Test"]}]' > /tmp/test_personas.json

# Test generate command (dry run or with mock)
persona script generate /tmp/test_personas.json \
    --scenario "Test conversation" \
    --turns 3 \
    --format json \
    --help  # Just check help works

echo "Exit code: $?"
```

**Expected:** CLI command works

**Pass Criteria:**
- [ ] Command accepts persona file
- [ ] --scenario flag works
- [ ] --turns flag works
- [ ] --format flag works
- [ ] --output flag works

---

## Test 7: Scenario Templates

**Command:**
```python
from persona.core.scripts import ConversationGenerator

generator = ConversationGenerator()

# Check built-in templates
templates = generator.list_templates()
print(f"Templates: {templates}")

assert "customer_support" in templates or len(templates) > 0
print("Scenario templates available")
```

**Expected:** Built-in scenario templates exist

**Pass Criteria:**
- [ ] Customer support template
- [ ] User onboarding template
- [ ] Product demo template
- [ ] Templates are customisable

---

## Test 8: Journey Generation

**Command:**
```python
from persona.core.scripts import ConversationGenerator

generator = ConversationGenerator()

# Check journey method exists
assert hasattr(generator, 'generate_journey')
print("Journey generation available")
```

**Expected:** User journey generation supported

**Pass Criteria:**
- [ ] generate_journey method exists
- [ ] Accepts persona and product
- [ ] Generates task-based script

---

## Test 9: CLI Journey Command

**Command:**
```bash
persona script journey --help
```

**Expected:** Journey subcommand exists

**Pass Criteria:**
- [ ] journey subcommand available
- [ ] --product flag documented
- [ ] --task flag documented

---

## Test 10: Documentation

**Command:**
```bash
# Check feature spec exists
ls docs/development/roadmap/features/completed/F-104-conversation-scripts.md

# Check guide exists
ls docs/guides/conversation-scripts.md

echo "Exit code: $?"
```

**Expected:** Documentation exists

**Pass Criteria:**
- [ ] Feature spec created
- [ ] Guide created
- [ ] Examples included
- [ ] All formats documented

---

## Results Summary

| Test | Status |
|------|--------|
| Test 1: Import | [ ] |
| Test 2: CLI Help | [ ] |
| Test 3: Models | [ ] |
| Test 4: Generator Init | [ ] |
| Test 5: Formatters | [ ] |
| Test 6: CLI Generate | [ ] |
| Test 7: Templates | [ ] |
| Test 8: Journey Gen | [ ] |
| Test 9: CLI Journey | [ ] |
| Test 10: Documentation | [ ] |

**Tested by:** ________________
**Date:** ________________
**Notes:**
