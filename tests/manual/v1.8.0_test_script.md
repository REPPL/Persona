# Manual Test Script: v1.8.0 - Technical Debt & Data Infrastructure

## Prerequisites

### Environment Setup
- [ ] Python 3.12+ installed
- [ ] Virtual environment activated (`.venv/`)
- [ ] All dependencies installed (`pip install -e ".[all]"`)

### For LLM-based Tests
- [ ] At least one LLM provider configured
- [ ] API keys in `.env` file or environment

---

## Test 1: Lazy Dependency Loading

**Purpose:** Verify CLI starts quickly without loading heavy dependencies.

```bash
# Time the CLI startup (should be < 1 second)
time persona --version

# Help should load quickly
time persona --help
```

**Expected Results:**
- [ ] Version displays in < 1 second
- [ ] Help displays in < 1 second
- [ ] No import warnings for optional dependencies

---

## Test 2: SQLite Experiment Store (F-124)

**Purpose:** Verify SQLite-based experiment storage works.

```bash
# Create test experiment
persona experiment create sqlite-test -d "Testing SQLite store"

# Check database file exists (if configured)
ls -la experiments/sqlite-test/
```

**Expected Results:**
- [ ] Experiment created successfully
- [ ] Directory structure created
- [ ] config.yaml present

---

## Test 3: Variant Management

**Purpose:** Test experiment variant creation and tracking.

```bash
# List variants (if any)
persona experiment show sqlite-test
```

**Expected Results:**
- [ ] Experiment details displayed
- [ ] No errors

---

## Test 4: Data Lineage Tracking (F-125)

**Purpose:** Verify provenance tracking for generated personas.

```bash
# Create test data
mkdir -p experiments/sqlite-test/data
echo "name,role,feedback
Alice,Developer,Loves fast builds
Bob,Designer,Needs better tooling" > experiments/sqlite-test/data/users.csv

# Generate with lineage tracking
persona generate --from experiments/sqlite-test/data/users.csv \
    --experiment sqlite-test \
    --count 1 \
    --provider anthropic
```

**Expected Results:**
- [ ] Generation completes
- [ ] Output includes source data reference
- [ ] Metadata captures input file info

---

## Test 5: Registry-Based Project Management

**Purpose:** Test global project registry system.

```bash
# Check project commands
persona project --help

# List projects (if available)
persona project list
```

**Expected Results:**
- [ ] Help displays project subcommands
- [ ] List command works (may be empty)

---

## Test 6: CLIContext Refactoring

**Purpose:** Verify CLI context management works correctly.

```bash
# Run commands that use CLIContext
persona check

# Config commands
persona config show
```

**Expected Results:**
- [ ] Check command shows provider status
- [ ] Config show works without errors

---

## Test 7: Quality Base Refactoring

**Purpose:** Verify quality metrics still work after refactoring.

```bash
# Create test persona for quality check
cat > /tmp/test_persona.json << 'EOF'
{
  "id": "test-1",
  "name": "Test User",
  "demographics": {"age": 30, "occupation": "Engineer"},
  "behaviours": ["Tests software", "Documents bugs"],
  "goals": ["Ship quality code"],
  "pain_points": ["Tight deadlines"]
}
EOF

# Run quality check
persona quality score /tmp/test_persona.json
```

**Expected Results:**
- [ ] Quality score calculated
- [ ] No import errors for quality modules

---

## Cleanup

```bash
# Remove test experiment
persona experiment delete sqlite-test --force

# Remove temp files
rm -f /tmp/test_persona.json
```

---

## Summary Checklist

| Test | Status |
|------|--------|
| Lazy dependency loading | [ ] |
| SQLite experiment store | [ ] |
| Variant management | [ ] |
| Data lineage tracking | [ ] |
| Registry-based projects | [ ] |
| CLIContext refactoring | [ ] |
| Quality base refactoring | [ ] |

**Tester:** _______________
**Date:** _______________
**Version:** v1.8.0
