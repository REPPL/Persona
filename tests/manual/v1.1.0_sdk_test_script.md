# Manual Test Script: Python SDK (F-105)

This script verifies the Python SDK functionality. Execute tests in order and record results.

## Prerequisites

- Python 3.12+
- Persona installed with `pip install -e ".[all]"`

## Setup

```bash
# 1. Activate virtual environment
source .venv-test/bin/activate  # On Windows: .venv-test\Scripts\activate

# 2. Verify installation
persona --version
```

**Expected:** Shows Persona version

---

## Test 1: SDK Import

**Command:**
```python
from persona.sdk import PersonaClient
from persona.sdk.models import PersonaResponse, ExperimentResponse
from persona.sdk.config import SDKConfig
from persona.sdk.exceptions import SDKError

print("SDK imports successful")
```

**Expected:** All SDK modules importable

**Pass Criteria:**
- [ ] PersonaClient importable
- [ ] Response models importable
- [ ] Config and exceptions importable
- [ ] No circular imports

---

## Test 2: Client Initialisation

**Command:**
```python
from persona.sdk import PersonaClient

# Default initialisation
client = PersonaClient()
print(f"Client created: {client}")

# With custom config
client = PersonaClient(
    provider="openai",
    model="gpt-4o",
)
print("Custom client created")
```

**Expected:** Client initialises with defaults and custom config

**Pass Criteria:**
- [ ] Default client creates successfully
- [ ] Custom provider/model accepted
- [ ] Configuration stored correctly

---

## Test 3: Configuration Priority

**Command:**
```python
import os
from persona.sdk import PersonaClient

# Set environment variable
os.environ["PERSONA_PROVIDER"] = "anthropic"

# Constructor should override env
client = PersonaClient(provider="openai")
assert client.config.provider == "openai"

print("Configuration priority correct")
```

**Expected:** Constructor args > env vars > config file

**Pass Criteria:**
- [ ] Constructor arguments take priority
- [ ] Environment variables work
- [ ] Config file loading works
- [ ] Correct precedence order

---

## Test 4: Response Models

**Command:**
```python
from persona.sdk.models import PersonaResponse, QualityReport

# Create response model
response = PersonaResponse(
    id="persona_001",
    name="Alex Chen",
    demographics={"age": 32, "occupation": "Software Engineer"},
    goals=["Improve productivity"],
    frustrations=["Too many meetings"],
)
print(f"Response model: {response}")

# Serialisation
data = response.model_dump()
assert "name" in data
print("Serialisation works")
```

**Expected:** Pydantic models work correctly

**Pass Criteria:**
- [ ] PersonaResponse validates data
- [ ] model_dump() serialises correctly
- [ ] model_validate() deserialises correctly
- [ ] Type validation working

---

## Test 5: SDK Exceptions

**Command:**
```python
from persona.sdk.exceptions import (
    SDKError,
    ValidationError,
    ProviderError,
    ConfigurationError,
)

# Test exception hierarchy
try:
    raise ValidationError("Invalid data")
except SDKError as e:
    print(f"Caught as SDKError: {e}")

print("Exception hierarchy correct")
```

**Expected:** Proper exception hierarchy

**Pass Criteria:**
- [ ] SDKError is base exception
- [ ] ValidationError extends SDKError
- [ ] ProviderError extends SDKError
- [ ] Clear error messages

---

## Test 6: Generate Method Signature

**Command:**
```python
from persona.sdk import PersonaClient
import inspect

client = PersonaClient()

# Check generate method exists with correct signature
sig = inspect.signature(client.generate)
params = list(sig.parameters.keys())

assert 'data' in params
assert 'count' in params
print(f"Generate params: {params}")
```

**Expected:** Generate method has correct parameters

**Pass Criteria:**
- [ ] data parameter exists
- [ ] count parameter exists
- [ ] provider/model parameters exist
- [ ] Returns PersonaResponse or list

---

## Test 7: Quality Integration

**Command:**
```python
from persona.sdk import PersonaClient

client = PersonaClient()

# Check quality scoring method exists
assert hasattr(client, 'score_quality') or hasattr(client, 'get_quality')
print("Quality integration available")
```

**Expected:** SDK integrates with quality scoring

**Pass Criteria:**
- [ ] Quality scoring method exists
- [ ] Returns QualityReport
- [ ] Integrates with core quality module

---

## Test 8: Plugin Integration

**Command:**
```python
from persona.sdk import PersonaClient

client = PersonaClient()

# Check plugin access
assert hasattr(client, 'list_plugins') or hasattr(client, 'plugins')
print("Plugin integration available")
```

**Expected:** SDK can access plugin system

**Pass Criteria:**
- [ ] Can list available plugins
- [ ] Can specify formatter plugin
- [ ] Can specify loader plugin

---

## Test 9: Documentation

**Command:**
```bash
# Check feature spec exists
ls docs/development/roadmap/features/completed/F-105-python-sdk.md

# Check guide exists
ls docs/guides/python-sdk.md

echo "Exit code: $?"
```

**Expected:** Documentation exists

**Pass Criteria:**
- [ ] Feature spec created
- [ ] SDK guide created
- [ ] Docstrings on all public methods
- [ ] Usage examples included

---

## Test 10: Type Hints

**Command:**
```python
from persona.sdk import PersonaClient
from persona.sdk.models import PersonaResponse
import typing

# Check type hints exist
hints = typing.get_type_hints(PersonaClient.generate)
print(f"Type hints: {hints}")
assert hints  # Should have return type
print("Type hints present")
```

**Expected:** All public methods have type hints

**Pass Criteria:**
- [ ] Return types annotated
- [ ] Parameter types annotated
- [ ] Complex types use typing module
- [ ] IDE autocomplete works

---

## Results Summary

| Test | Status |
|------|--------|
| Test 1: Import | [ ] |
| Test 2: Client Init | [ ] |
| Test 3: Config Priority | [ ] |
| Test 4: Response Models | [ ] |
| Test 5: Exceptions | [ ] |
| Test 6: Generate Signature | [ ] |
| Test 7: Quality Integration | [ ] |
| Test 8: Plugin Integration | [ ] |
| Test 9: Documentation | [ ] |
| Test 10: Type Hints | [ ] |

**Tested by:** ________________
**Date:** ________________
**Notes:**
